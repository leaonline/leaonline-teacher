<template name="class">
    <h1>
        {{#onLoaded loaded=loadComplete}}{{i18n "pages.class.title"}}{{/onLoaded}}
        {{title}}
    </h1>

    {{#onLoaded loaded=loadComplete}}
        <select class="form-control border-{{color}} text-{{color}}"
                id="dimension-select">
            <option value="">{{i18n "form.selectOne"}}</option>
            {{#each dimension in dimensions}}
                <option value="{{dimension._id}}">{{dimension.title}}</option>
            {{/each}}
        </select>
    {{/onLoaded}}

    {{#if dimensionDoc}}
        {{#unless otuleaConnected}}
            <div class="alert alert-info">
                {{> loading title="otulea"}}
            </div>
        {{/unless}}
        {{#onLoaded loaded=visualizationData}}
            {{#unless hasFeedback}}
                <div class="alert alert-warning mt-3">
                    {{i18n "pages.class.noFeedback"}}
                </div>
            {{else}}
                {{#if visualizationData}}
                    {{> visualization visualizationData}}
                {{/if}}


                {{#with processed}}
                    <h3>AlphaLevels</h3>
                    <ul class="list-group">
                        {{#each entry in this.alphaLevels}}
                        <li class="list-group-item">
                            <span>
                                {{#with alphaLevelDoc entry.id}}
                                    {{this.description}}
                                {{else}}
                                    {{entry.id}}
                                {{/with}}
                            </span>: {{entry.score}} ({{entry.count}})
                        </li>
                        {{/each}}
                    </ul>

                    <h3>Competencies</h3>
                    <ul class="list-group">
                        {{#each entry in this.competencies}}
                            <li class="list-group-item">
                            <span>
                                {{#with competencyDoc entry.id}}
                                    {{this.description}}
                                {{else}}
                                    {{entry.id}}
                                {{/with}}
                            </span>: {{entry.score}} ({{entry.count}})
                            </li>
                        {{/each}}
                    </ul>
                {{/with}}
            {{/unless}}
        {{/onLoaded}}
    {{/if}}
</template>

<template name="competencyCategoryForCourse">
    <div>{{i18n "pages.class.compCategory"}}: {{this.competencyCategory}}</div>
    <div>{{i18n "pages.class.competencies"}}: {{this.compCount}}</div>
    <div>{{i18n "common.progress"}}: {{this.progress}}</div>
    <div>{{i18n "common.users"}}: {{this.userCount}}</div>

    {{#each competency in this.competencies}}
        {{> competencyForCourse competency}}
    {{/each}}
</template>

<template name="competencyForCourse">
    <div>{{i18n "alphaLevel.title"}}: {{this.alphaLevel}}</div>
    <div>{{i18n "common.description"}}: {{this.description}}</div>
    <div>{{i18n "common.progress"}}: {{this.progress}}</div>
    {{#each entry in this.users}}
        <div>{{i18n "common.user"}}: {{entry.name}}</div>
        <div>{{i18n "common.progress"}}: {{entry.progress}}</div>
    {{/each}}
</template>